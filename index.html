<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Character Sheet</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Alkatra&family=Cinzel+Decorative:wght@400;700;900&family=Concert+One&family=Delicious+Handrawn&family=Merriweather:ital@1&family=Roboto+Mono&display=swap" rel="stylesheet">
</head>
<body>
    <div class="sheet-container">
        <h1 class="texto1">SANGUINOLENCIA</h1>
        
        <div class="section">
            <div class="section-title"></div>
            <div class="stat-row">
                <div class="stat">
                    <div class="stat-label">Nome:</div>
                    <div class="stat-value" contenteditable="true"></div>
                </div>
                <div class="stat">
                    <div class="stat-label">Classe:</div>
                    <div class="stat-value" contenteditable="true"></div>
                </div>
            </div>
        </div>
        
        <div class="section">
            <div class="stat-row">
                <div class="stat">
                    <div class="stat-label texto1">HP:</div>
                    <input type="number" min="0" class="stat-value1" contenteditable="true">
                </div>
                <div class="stat">
                    <div class="stat-label texto1">SP:</div>
                    <input type="number" min="0" class="stat-value1" contenteditable="true">
                </div>
                <div class="stat">
                    <div class="stat-label texto1">MP:</div>
                    <input type="number" min="0" class="stat-value1" contenteditable="true">
                </div>
                <div class="stat">
                    <div class="stat-label texto1">Peso:</div>
                    <input type="number" max="7" min="0" class="stat-value1" contenteditable="true">
                </div>
            </div>
        </div>
        
        <div class="section">
            <div class="section-title"></div>
            <div class="stat-row">
                <div class="stat">
                    <div class="stat-label">Item Querido:</div>
                    <div class="stat-value" contenteditable="true"></div>
                </div>
            </div>
        </div>
        
        <div class="section">
            <div> <h1 class="section-title, texto1"> História </h1> </div>
            <textarea placeholder="Conte o seu passado aqui"></textarea>
        </div>
        
        <div class="section">
            <div class="section-title"><h1 class="texto1">Inventario</h1></div>
            <div class="inventory-item" contenteditable="true"></div>
            <div class="inventory-item" contenteditable="true"></div>
            <div class="inventory-item" contenteditable="true"></div>
            <button style="margin-top: 10px; padding: 5px 10px;">Adicionar Item</button>
        </div>

        <div class="section">
            <div class="section-title">
                <h1 class="texto1">Encantamentos</h1>
            </div>
            <div class="inventory-item" contenteditable="true"></div>
            <div class="inventory-item" contenteditable="true"></div>
            <div class="inventory-item" contenteditable="true"></div>
            <button style="margin-top: 10px; padding: 5px 10px;">Adicionar Encantamentos</button>
        </div>
    </div> 

    <script>
             // Função para salvar TODOS os dados da ficha
    function saveCharacter() {
        const characterData = {
            // Dados básicos
            nome: document.querySelector('.stat-value').textContent,
            classe: document.querySelectorAll('.stat-value')[1].textContent,
            hp: document.querySelector('input[type="number"]').value,
            sp: document.querySelectorAll('input[type="number"]')[1].value,
            mp: document.querySelectorAll('input[type="number"]')[2].value,
            peso: document.querySelectorAll('input[type="number"]')[3].value,
            itemQuerido: document.querySelectorAll('.stat-value')[2].textContent,
            historia: document.querySelector('textarea').value,
            
            // Inventário (todos os itens, incluindo os adicionados dinamicamente)
            inventario: Array.from(document.querySelectorAll('.section:nth-last-child(2) .inventory-item')).map(item => item.textContent),
            
            // Encantamentos (todos os itens, incluindo os adicionados dinamicamente)
            encantamentos: Array.from(document.querySelectorAll('.section:last-child .inventory-item')).map(item => item.textContent)
        };

        // Salva no LocalStorage
        localStorage.setItem('characterData', JSON.stringify(characterData));
        alert('Ficha salva com sucesso!');
    }

    // Função para carregar TODOS os dados da ficha
    function loadCharacter() {
        const savedData = localStorage.getItem('characterData');
        if (savedData) {
            const characterData = JSON.parse(savedData);

            // Preenche os campos básicos
            document.querySelector('.stat-value').textContent = characterData.nome || '';
            document.querySelectorAll('.stat-value')[1].textContent = characterData.classe || '';
            document.querySelector('input[type="number"]').value = characterData.hp || '';
            document.querySelectorAll('input[type="number"]')[1].value = characterData.sp || '';
            document.querySelectorAll('input[type="number"]')[2].value = characterData.mp || '';
            document.querySelectorAll('input[type="number"]')[3].value = characterData.peso || '';
            document.querySelectorAll('.stat-value')[2].textContent = characterData.itemQuerido || '';
            document.querySelector('textarea').value = characterData.historia || '';

            // Preenche o inventário (remove os itens existentes e adiciona os salvos)
            const inventorySection = document.querySelector('.section:nth-last-child(2)');
            const inventoryItems = inventorySection.querySelectorAll('.inventory-item');
            inventoryItems.forEach(item => item.remove()); // Remove os itens padrão
            
            characterData.inventario.forEach(itemText => {
                const newItem = document.createElement('div');
                newItem.className = 'inventory-item';
                newItem.contentEditable = true;
                newItem.textContent = itemText;
                inventorySection.insertBefore(newItem, inventorySection.querySelector('button'));
            });

            // Preenche os encantamentos (remove os existentes e adiciona os salvos)
            const enchantSection = document.querySelector('.section:last-child');
            const enchantItems = enchantSection.querySelectorAll('.inventory-item');
            enchantItems.forEach(item => item.remove()); // Remove os itens padrão
            
            characterData.encantamentos.forEach(itemText => {
                const newItem = document.createElement('div');
                newItem.className = 'inventory-item';
                newItem.contentEditable = true;
                newItem.textContent = itemText;
                enchantSection.insertBefore(newItem, enchantSection.querySelector('button'));
            });
        }
    }

    // Adiciona o botão de Salvar
    const saveButton = document.createElement('button');
    saveButton.textContent = 'Salvar Personagem';
    saveButton.style.marginTop = '10px';
    saveButton.style.padding = '5px 10px';
    saveButton.onclick = saveCharacter;
    document.querySelector('.sheet-container').appendChild(saveButton);

    // Carrega automaticamente ao abrir a página
    window.addEventListener('DOMContentLoaded', loadCharacter);

    // Script para adicionar itens dinamicamente (já existente)
    document.querySelectorAll('button').forEach(button => {
        button.addEventListener('click', function() {
            const section = this.closest('.section');
            const newItem = document.createElement('div');
            newItem.className = 'inventory-item';
            newItem.contentEditable = 'true';
            section.insertBefore(newItem, this);
        });
    });
        // Seleciona TODOS os botões e adiciona o evento de clique
        document.querySelectorAll('button').forEach(button => {
            button.addEventListener('click', function() {
                const section = this.closest('.section');
                const newItem = document.createElement('div');
                newItem.className = 'inventory-item';
                newItem.contentEditable = 'true';
                section.insertBefore(newItem, this);
            });
        });
    </script>

</body>
</html>